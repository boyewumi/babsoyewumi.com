import{B as L,h as P,A as j,C as U,D as B,o as O,t as _,u as k,s as q}from"./useFocusable-D3uVX1Jv.js";import{r as u,R as F}from"./iframe-BZ0nXjex.js";function H(e,a){let{id:t,"aria-label":i,"aria-labelledby":l}=e;return t=L(t),l&&i?l=[...new Set([t,...l.trim().split(/\s+/)])].join(" "):l&&(l=l.trim().split(/\s+/).join(" ")),!i&&!l&&a&&(i=a),{id:t,"aria-label":i,"aria-labelledby":l}}function z(e,a,t){let i=P(()=>{t&&t(a)});u.useEffect(()=>{var l;let r=e==null||(l=e.current)===null||l===void 0?void 0:l.form;return r?.addEventListener("reset",i),()=>{r?.removeEventListener("reset",i)}},[e,i])}function K(e,a,t){let[i,l]=u.useState(e||a),r=u.useRef(e!==void 0),o=e!==void 0;u.useEffect(()=>{r.current,r.current=o},[o]);let d=o?e:i,c=u.useCallback((s,...n)=>{let v=(b,...m)=>{t&&(Object.is(d,b)||t(b,...m)),o||(d=b)};typeof s=="function"?l((m,...V)=>{let $=s(o?d:m,...V);return v($,...n),o?m:$}):(o||l(s),v(s,...n))},[o,d,t]);return[d,c]}const A={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},T={...A,customError:!0,valid:!1},M={isInvalid:!1,validationDetails:A,validationErrors:[]},Q=u.createContext({}),w="__formValidationState"+Date.now();function N(e){if(e[w]){let{realtimeValidation:a,displayValidation:t,updateValidation:i,resetValidation:l,commitValidation:r}=e[w];return{realtimeValidation:a,displayValidation:t,updateValidation:i,resetValidation:l,commitValidation:r}}return Y(e)}function Y(e){let{isInvalid:a,validationState:t,name:i,value:l,builtinValidation:r,validate:o,validationBehavior:d="aria"}=e;t&&(a||(a=t==="invalid"));let c=a!==void 0?{isInvalid:a,validationErrors:[],validationDetails:T}:null,s=u.useMemo(()=>{if(!o||l==null)return null;let f=G(o,l);return R(f)},[o,l]);r?.validationDetails.valid&&(r=void 0);let n=u.useContext(Q),v=u.useMemo(()=>i?Array.isArray(i)?i.flatMap(f=>D(n[f])):D(n[i]):[],[n,i]),[b,m]=u.useState(n),[V,$]=u.useState(!1);n!==b&&(m(n),$(!1));let g=u.useMemo(()=>R(V?[]:v),[V,v]),C=u.useRef(M),[E,h]=u.useState(M),y=u.useRef(M),x=()=>{if(!I)return;p(!1);let f=s||r||C.current;S(f,y.current)||(y.current=f,h(f))},[I,p]=u.useState(!1);return u.useEffect(x),{realtimeValidation:c||g||s||r||M,displayValidation:d==="native"?c||g||E:c||g||s||r||E,updateValidation(f){d==="aria"&&!S(E,f)?h(f):C.current=f},resetValidation(){let f=M;S(f,y.current)||(y.current=f,h(f)),d==="native"&&p(!1),$(!0)},commitValidation(){d==="native"&&p(!0),$(!0)}}}function D(e){return e?Array.isArray(e)?e:[e]:[]}function G(e,a){if(typeof e=="function"){let t=e(a);if(t&&typeof t!="boolean")return D(t)}return[]}function R(e){return e.length?{isInvalid:!0,validationErrors:e,validationDetails:T}:null}function S(e,a){return e===a?!0:!!e&&!!a&&e.isInvalid===a.isInvalid&&e.validationErrors.length===a.validationErrors.length&&e.validationErrors.every((t,i)=>t===a.validationErrors[i])&&Object.entries(e.validationDetails).every(([t,i])=>a.validationDetails[t]===i)}function J(e,a,t){let{validationBehavior:i,focus:l}=e;j(()=>{if(i==="native"&&t?.current&&!t.current.disabled){let s=a.realtimeValidation.isInvalid?a.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";t.current.setCustomValidity(s),t.current.hasAttribute("title")||(t.current.title=""),a.realtimeValidation.isInvalid||a.updateValidation(X(t.current))}});let r=u.useRef(!1),o=P(()=>{r.current||a.resetValidation()}),d=P(s=>{var n;a.displayValidation.isInvalid||a.commitValidation();let v=t==null||(n=t.current)===null||n===void 0?void 0:n.form;if(!s.defaultPrevented&&t&&v&&Z(v)===t.current){var b;l?l():(b=t.current)===null||b===void 0||b.focus(),U("keyboard")}s.preventDefault()}),c=P(()=>{a.commitValidation()});u.useEffect(()=>{let s=t?.current;if(!s)return;let n=s.form,v=n?.reset;return n&&(n.reset=()=>{r.current=!window.event||window.event.type==="message"&&window.event.target instanceof MessagePort,v?.call(n),r.current=!1}),s.addEventListener("invalid",d),s.addEventListener("change",c),n?.addEventListener("reset",o),()=>{s.removeEventListener("invalid",d),s.removeEventListener("change",c),n?.removeEventListener("reset",o),n&&(n.reset=v)}},[t,d,c,o,i])}function W(e){let a=e.validity;return{badInput:a.badInput,customError:a.customError,patternMismatch:a.patternMismatch,rangeOverflow:a.rangeOverflow,rangeUnderflow:a.rangeUnderflow,stepMismatch:a.stepMismatch,tooLong:a.tooLong,tooShort:a.tooShort,typeMismatch:a.typeMismatch,valueMissing:a.valueMissing,valid:a.valid}}function X(e){return{isInvalid:!e.validity.valid,validationDetails:W(e),validationErrors:e.validationMessage?[e.validationMessage]:[]}}function Z(e){for(let a=0;a<e.elements.length;a++){let t=e.elements[a];if(!t.validity.valid)return t}return null}function ee(e){let{id:a,label:t,"aria-labelledby":i,"aria-label":l,labelElementType:r="label"}=e;a=L(a);let o=L(),d={};t&&(i=i?`${o} ${i}`:o,d={id:o,htmlFor:r==="label"?a:void 0});let c=H({id:a,"aria-label":l,"aria-labelledby":i});return{labelProps:d,fieldProps:c}}function ae(e){let{description:a,errorMessage:t,isInvalid:i,validationState:l}=e,{labelProps:r,fieldProps:o}=ee(e),d=B([!!a,!!t,i,l]),c=B([!!a,!!t,i,l]);return o=O(o,{"aria-describedby":[d,c,e["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:r,fieldProps:o,descriptionProps:{id:d},errorMessageProps:{id:c}}}function ne(e,a){let{inputElementType:t="input",isDisabled:i=!1,isRequired:l=!1,isReadOnly:r=!1,type:o="text",validationBehavior:d="aria"}=e,[c,s]=K(e.value,e.defaultValue||"",e.onChange),{focusableProps:n}=_(e,a),v=N({...e,value:c}),{isInvalid:b,validationErrors:m,validationDetails:V}=v.displayValidation,{labelProps:$,fieldProps:g,descriptionProps:C,errorMessageProps:E}=ae({...e,isInvalid:b,errorMessage:e.errorMessage||m}),h=k(e,{labelable:!0});const y={type:o,pattern:e.pattern};let[x]=u.useState(c);var I;return z(a,(I=e.defaultValue)!==null&&I!==void 0?I:x,s),J(e,v,a),u.useEffect(()=>{if(a.current instanceof q(a.current).HTMLTextAreaElement){let p=a.current;Object.defineProperty(p,"defaultValue",{get:()=>p.value,set:()=>{},configurable:!0})}},[a]),{labelProps:$,inputProps:O(h,t==="input"?y:void 0,{disabled:i,readOnly:r,required:l&&d==="native","aria-required":l&&d==="aria"||void 0,"aria-invalid":b||void 0,"aria-errormessage":e["aria-errormessage"],"aria-activedescendant":e["aria-activedescendant"],"aria-autocomplete":e["aria-autocomplete"],"aria-haspopup":e["aria-haspopup"],"aria-controls":e["aria-controls"],value:c,onChange:p=>s(p.target.value),autoComplete:e.autoComplete,autoCapitalize:e.autoCapitalize,maxLength:e.maxLength,minLength:e.minLength,name:e.name,form:e.form,placeholder:e.placeholder,inputMode:e.inputMode,autoCorrect:e.autoCorrect,spellCheck:e.spellCheck,[parseInt(F.version,10)>=17?"enterKeyHint":"enterkeyhint"]:e.enterKeyHint,onCopy:e.onCopy,onCut:e.onCut,onPaste:e.onPaste,onCompositionEnd:e.onCompositionEnd,onCompositionStart:e.onCompositionStart,onCompositionUpdate:e.onCompositionUpdate,onSelect:e.onSelect,onBeforeInput:e.onBeforeInput,onInput:e.onInput,...n,...g}),descriptionProps:C,errorMessageProps:E,isInvalid:b,validationErrors:m,validationDetails:V}}export{ne as $};
